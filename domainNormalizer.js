#!/usr/bin/env node

const fs = require("fs").promises;

const readFile = async filename => {
  try {
    return await fs.readFile(filename, "utf-8");
  } catch(err) {
    console.error(err);
    return null;
  }
}

const filename = process.argv[2];
if (!filename) {
  console.error("You need to provide filename as argument");
  process.exit(0);
}

(async () => {
  const data = await readFile(filename);
  if (!data) {
    console.error("Unable to read file");
    process.exit(0);
  }

  const parsedFile = [
    ...new Set(
      data.split("\n").flatMap((line) => {
        const cleanedLine = line.replace(/\*\./g, "");
        if (cleanedLine) {
          return [`https://${cleanedLine}`, `http://${cleanedLine}`];
        }
      })
    ),
  ].join("\n");


  console.log(parsedFile);
})();
